from sqlalchemy import create_engine
from sqlalchemy.orm import Session, declarative_base
from config import (
    MYSQL_USER,
    MYSQL_PASSWD,
    MYSQL_HOST,
    MYSQL_PORT,
    DB_CVSS_20,
    DB_CVSS_30,
    DB_CVSS_31,
)


Base = declarative_base()


engine_cvss20 = create_engine(
    f"mysql+mysqlconnector://{MYSQL_USER}:{MYSQL_PASSWD}@{MYSQL_HOST}:{MYSQL_PORT}/{DB_CVSS_20}",
    future=True,
    echo=True,
)
engine_cvss30 = create_engine(
    f"mysql+mysqlconnector://{MYSQL_USER}:{MYSQL_PASSWD}@{MYSQL_HOST}:{MYSQL_PORT}/{DB_CVSS_30}",
    future=True,
    echo=True,
)
engine_cvss31 = create_engine(
    f"mysql+mysqlconnector://{MYSQL_USER}:{MYSQL_PASSWD}@{MYSQL_HOST}:{MYSQL_PORT}/{DB_CVSS_31}",
    future=True,
    echo=True,
)


def connect_cvss20(query):
    with Session(connect_cvss20) as session:
        with session.begin():
            result = session.execute(query)
    return result

def connect_cvss30(query):
    with Session(connect_cvss30) as session:
        with session.begin():
            result = session.execute(query)
    return result

def connect_cvss31(query):
    with Session(connect_cvss31) as session:
        with session.begin():
            result = session.execute(query)
    return result
